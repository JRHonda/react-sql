# Setup

# Setup MySQL Workbench
1. Download MySQL Workbench at https://dev.mysql.com/downloads/workbench/
2. Install MySQL
3. Start MySQL server on port 3306:
4. Under the Adminstration tab, click on Users and Privileges and add an Account with the user as 'admin' and password as 'admin'. The code base uses this to connect to the database, nothing else.
4. Use the react_sql_user.sql script in MySQL Workbench by selecting File > Open SQL Script...
5. Execute the script by clicking on the lightning bolt just to the right of the save disk icon.
6. The `react_sql` schema is created along with the pre-filled `user` table.

# Start server
1. Open a Terminal window and change to the /server directory of the react-sql directory'
2. Using Nodemon (you might need to add this if you don't have, `npm install -g nodemon`), type into the Terminal `nodemon index.js`
3. The server should indicate that it is listening on port 3000.

# Start Application
1. Open a new Terminal window and change to the projects root directory.
2. Type into the Terminal, `npm start`
3. The Terminal will likely ask you if you want to start the application on a different port since port 3000 is being used. Select Yes, or type shift+Y.
4. Go on to the Overview.

# Overview
This code base demonstrates the following attacks:


// Vulnerability #1 - Injection Attack                                        //
// Inserting the following text in password input field retrieves all users   //
// in the `user` table in the `react_sql` database:                           //
//                                                                            //
//                ;' OR 'x'='x                                                //
//                                                                            //
// The results are printed to the console.                                    //



// Vulnerability #2 - Implementation Mistake                                  //
// The admin account is saved under the main user table contained within the  //
// the database. This makes it easier for an attacker to access admin account //
// information since all user information is collected under a single table.  //
// The secondary implementation mistake here is performing logic to award     //
// administrative permissions if the user that logged in has the username     //
// equal to 'admin'.


# Vulnerability 1: Injection Attack

The code allows an attacker to retrieve all users information contained within
the `user` table. This allows the attacker to be able to login for any user
they wish.

1. The attacker can enter a typical injection attack which uses a true `boolean`
to trick the database to return all results. Such an attack can be typed within
the password input field. The attack demonstrated is:
 
       ;' OR 'x'='x

2. The injection is concatenated with a SELECT SQL query which results in
`SELECT * FROM user WHERE username='<anything>' AND password=;' OR 'x'='x`

3. The SQL query is passed to the MySQL database and returns all contents within
the `user` table since the boolean x=x is true.

The vulnerability can be exploited by following the steps below:

1.a Using curl, send the following request to the server:

    curl -X GET 'http://localhost:3000/user?userame=&password=;%27%20OR%20%27x%27=%27x'

1.b Using the web application, leave the username input field blank and type the
following in the password input field:

    ;' OR 'x'='x

2. The server should send back an Object with all of the contents within the
`user` table.

3. The attacker can then login as any of the users.

# Vulnerability 2: Implemention Attack

The code allows an attacker to create duplicate user accounts. This will allow
the attacker to login as an administrator, performing any admin functions as
they wish.

1. The mistake surrounds database setup and logic performed within the code base.

2. Separation of roles is not implemented which allows attackers to easily
access information. Separation of roles would demand creating separate tables
for bankers and administrators. Furthermore, naming conventions of tables and
administrator accounts should not be obvious. Otherwise, brute-force attempts
by attackers can overcome this type of simplfied naming convention.

The vulnerability can be exploited by following the steps below:

1. Click on the Sign Up button which opens a modal view to enter information
to sign up.

2. Enter the following information for each of the input fields:
 
        email: admin@email.com,
        password: <anything you want to enter>,
        phone: <anything you want to enter>,
        ssn: <anything you want to enter>


3. Once you hit submit, an account is created without performing a check to see
if the current user exists and if the email entered is valid. This is the
implementation mistake.

4. Close the modal window and login in. The application checks to see if 'admin'
is logged in, and if they are, the Admin web page would show. This is indicated
by the redirected URL in the address browser as well as an alert welcoming the
admin.

5. With further implementation of the web application, the attacker would be
able to make a wide variety of modifications to the application that could lead
to stealing information and ultimately money from VandyBank bankers.
